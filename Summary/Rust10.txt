10章 列挙体とパターン

列挙型(enumerations)もしくはenum
→名前付きの定数の集合を値とする独自の型

Rustの列挙型
→様々な型のデータを持つことが可能
→→共用体(union)に近い

ある値が複数のもののいずれかしか取らないときに有効
→代償はパターンマッチを使ってデータを安全にアクセスしなければならないこと
→→Rustのパターンはデータに対する正規表現のようなもの

10.1 列挙型

C styleの列挙型

enum Name {
    variant1,
    variant2,
    ...
}

取りうる値
→ヴァリアント(variant)もしくは構成子(constructors)と呼ぶ

enumerationsやvariantをimportすることができる
→variantをインポートしておけばhoge::varをvarとして使える
→→明示的でなくなるのでしないほうが良いが可読性とのトレードオフで

現在のmoduleに宣言されている列挙型のvariantをimportするにはselfインポートを使う

メモリ上では整数として表現される
→もちろんどの整数値を使うべきか指定できる
→未指定の場合0から順番に値を決める
→→デフォルトでは値を表現できる最小の型を使う

#[repr]属性を付加することでメモリ上の表現を指定することができる
→詳しくは 21章 unsafeなコード

列挙型から整数型へのキャストは許されている(as演算子を用いる)
→整数型から列挙型へのキャストはenum宣言内の値になる保証ができないので不可
→→自分でチェックしながらmatchで変換することはできる
→→もしくはenum_primitiveクレート(自動生成マクロ)を使ってもよい

構造体と同様に#[derive(Copy, Clone,...)]で明示的に要求すると機能をコンパイラが実装

構造体と同様メソッドを持つこともできる(impl)

10.1.1 データを保持する列挙体

タプル型ヴァリアント(tuple variants):
列挙型のvariantのうち引数を持つもの

→tupleの時と同じでこの書き方(コンストラクタ)が新たなRoughTime値を作るための関数になる

構造体型ヴァリアント(struct variants):
名前付きフィールドを持つヴァリアント

variant ⟷  unit型構造体
tuple variant ⟷  tuple structure
struct variant ⟷  named field

１つの列挙体にこれらが混ざっても構わない



































































































































































































