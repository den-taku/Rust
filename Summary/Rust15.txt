15章 イテレータ

イテレータ(iterator):
値の列を生成する値
→生成した値にループ処理を行うために用いる

Rustでは各種コレクションから要素を取り出して処理するイテレータが良いされている
→他にも色々

1..n+1はRange<i32>の値
→Range<i32>は1からnまでの整数を返すイテレータ

foldメソッド
→慣れてしまえば読みやすくてコンパクトなループの代用になる
→速度より表現力重視の関数型プログラミング言語でよく使われる書き方
→→Rustはリリースビルド時foldをインライン化するので高速

Rustは簡単な計算があればそれに置き換えてしまう

15.1 IteratorトレイトとIntoIteratorトレイト

イテレータ:
std::iter::Iteratorトレイトを実装する値

trait Iterator {
    type Item;
    fn next(&mut self) -> ->Option<Self::Item>;
    ... // many default methods
}

ある型に対して自然にスキャンする方法がある
→std::iter::IntoIteratorトレイトを実装できる

trait IntoIterator where Self::IntoIter::Item == Self::Item {
    type Item;
    type IntoIter: Iterator;
    fn into_iter(self) -> Self::IntoIter; // 型の値を受け取りイテレータを返す
}

IntoIteratorを実装する全ての型
→イテレート可能(iterable)と呼ぶ

forループは次のような呼び出しを短く書いたものに過ぎない

let mut iterator = (&v).into_iter();
while let Some(element) = iterator.next() {
    // code
}

forループに直接イテレータを渡すこともできる
→全てのイテレータは自動的にIntoIteatorを実装していて自分自身を返す

イテレータがNoneを返したあとでさらにnextメソッドを呼び出す
→何が起こるかをIteratorは規定していない
→ほとんどのイテレータは再度Noneを返すが全てがそうするわけではない

用語
・イテレータはIteratorを実装した任意の型
・イテレート可能(iterable)はIntoIteratorを実装した任意の型。into_iterメソッドでイテレータを取得できる
・イテレータは値を生成する
・イテレータが生成する値をアイテムと呼ぶ
・イテレータが生成するアイテムを受け取るコードは消費者(consumer)

15.2 イテレータの作成

標準ライブラリのドキュメント
→それぞれの型がどのようなイテレータを提供しているかを詳細に説明している

15.2.1 iterメソッドとiter_mutメソッド

多くのコレクション型がその型に対する自然なイテレータを返すiterとiter_mutを提供
→個々の要素に対する共有参照と変更可能参照を返す
→→forループに任せる以外の方法でイテレータを取得する一般的な方法

それぞれの型の目的に合わせて様々な実装ができる























































































