21章 unsafeなコード

Rustの推論では安全と認識できないが有用なテクニックは存在する

unsafeなコード
→プログラマの責任で安全性を担保する
→→型チェック、生存期間チェック、インデックスの境界チェックなどの通常のチェックは行われる

unsafeブロックは通常の安全なRustコードとの境界を明確にする

関数をunsafeにすることもできる
→呼び出し元に対して未定義動作を防ぐためのルールの警告ができる

rawポインタを使えば無制限にメモリアクセスできる

Rustの外部関数インターフェイスを使うと他の言語で書かれたライブラリを使用できる

unsafeトレイトはそれぞれの実装が従わなくてはならない制約を課す

21.1 何に対してunsafeなのか

unsafe機能はなんらかの契約(contract)を課す
→未定義動作を避けるために従わなければならないルール

典型的には契約はドキュメントに記述されるだけでコンパイラは知ることができない

未定義動作が起きたとき、Rustは結果を予測するのをやめる

unsafeブロックやunsafe関数をかく
→プログラマが追加されたルールのことを了承しているということ

21.2 unsafeなブロック


































































































