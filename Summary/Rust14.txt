14章 クロージャ

クロージャ(closure):
無名関数式
→クロージャの使われ方によってRustが自動的に引数の型と返り値の型を推論してくれる

クロージャを受け取ることができる標準ライブラリの機能
・データ列を処理するために
・新しいシステムスレッドを開始するために(並列実行の本質:仕事を他のスレッドに渡すこと)
・デフォルト値をクロージャで渡す場合

14.1 変数のキャプチャ

クロージャは外側の関数に属するデータを使うことができる

RustはGCがないのでリターンすると変数や引数がスコープから外れて捨てられてしまう

14.1.1 借用するクロージャ

Rustはガベージコレクションではなく生存期間を使って安全性を保証する(参照を借用)

14.1.2 盗むクロージャ

スレッドは呼び出し元と並列に実行される
クロージャがリターンすると新しいスレッドは終了する(→19章)

moveキーワード
→クロージャの前につける
→そのクロージャが変数を借用するのではなく所有権を「盗む」ことをRust処理系に伝える

クロージャは外側のスコープからデータを取得する方法を2つ用意している
→移動と借用に関するルールに従う(4,5章)

・コピー可能な型は移動でなくコピーが行われる
・非コピー型は移動が起きる
・もし移動後も変数を使いたければクローンして他の変数に格納しておけば良い

スレッド安全性につながる

14.2 関数型とクロージャ型





























































































