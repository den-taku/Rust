3章 基本的な型

Rustの型の目的:
安全性→コンパイラでチェック
効率性→不要な汎用性や柔軟性を排除
簡潔性→C++よりも簡潔なプログラム

Rust:静的に型付けされた(statically typed)言語
→コンパイラが事前に型チェック
→→事前に明示的に型を選ぶ
→→→補助する２つの機能

推論(infer):
一意に定まる変数や式の型をコンパイラ自身が決定

ジェネリック(generic):
必要な条件を満たす全ての型に対して機能するような関数定義(duck typing)
関数の目的と実装が十分一般的である必要がある
→詳しくは11章 トレイトとジェネリクスで

3.1 機械語型

型の基盤:固定長の数値型と真偽値と文字列
→ハードウェア上の実装と合致

数値型
→サイズ(bit)と表現方法で名前を表現
計算機のワード長(machine word)
→プログラムが実行される計算機でのアドレスサイズ。普通32か64。

bit   符号なし整数 符号付き整数 浮動小数点数
 8    u8           i8
16    u16          i16
32    u32          i32          f32 
64    u64          i64          f64
word  usize        isize

3.1.1 整数型

符号なし整数
→0と正の値を表現
符号つき整数
→2の補数表現で正の数と負の数を表現

→char型とは区別される
→ただしバイトリテラル(byte literals)ではASCIIコードを格納可能
→→ b'A' == 65u8
→→→ただしエスケープ必要な文字もあり \' \\ \n \r \t
→→→16進数で書くこともできる b'\xHH'

usize isize:
実行対象計算機のアドレス空間サイズ。
配列のインデックスやサイズ、データ構造の要素数なども一般にusize

デバッグビルド時
→数値演算のオーバーフローをチェック
リリースビルド時
→オーバーフローはラップ(wrap)
→→デバッグビルド時等常にラップしたいのなら次のように書く
 let x = big_val.wrapping_add(1);

整数リテラル
→型を後ろにつける 42u8 1729isize
→→推論で一意に決まればその型
→→i32が残ればi32
→→推論でi32が残らなければエラー

0x:16進数のリテラル
0o: 8進数のリテラル
0b: 2進数のリテラル
→アンダースコア(_)を入れてもよい 4_294_967_295 0xffff_ffff 127_u8

整数型から整数型への変換
→as演算子(詳しくは6.13 型キャスト)
→→変換先の範囲からはみ出す場合は2^Nによる剰余(N:変換先のbit数)
→→→切り捨て(truncation)という

整数もメソッドを持てる
→オンラインドキュメントでstdライブラリの操作を確認可(std::i32等で検索)
→→pow abs count_ones など

→呼び出し順:メソッド呼び出し>単項前置演算子
→→-4i32.abs() = -4

3.1.2 浮動小数点数

f32:IEEE単精度
f63:IEEE倍精度

(整数部)(.小数部)(指数部)(型指定子)
        31415.926e-4f64
小数部以降は省略可能だが、整数リテラルと区別するためどれか１つは必要
→小数点のみで小数部は表記可能
→→f32とf64どちらにも推論可能な時、f64が選ばれる

std::f32,std::f64には以下のものが定義
INFINITY, NEG_INFINITY, NAN, MIN, MAX

std::f32::consts,std::f64::constには様々な数学の定数が定義
→E,PI,√2...

f32やf64には一連の数学計算用のメソッドが定義されている

"暗黙の"型変換はコンパイルされない
→型変換はas演算子で(詳しくは6.13 型キャスト)

型推論は関数定義の中で閉じているので引数や戻り値から推論はされない




















































































































































































































































































































