20章 マクロ

Rustはマクロ(macro)機能をサポートしている
→関数だけではできないような言語拡張がマクロなら実現できる

マクロはある種の短縮記法
→コンパイル時に型チェックや機械コードの生成より前にマクロ呼び出しは展開される

マクロ呼び出し時には常に!をつける
→通常の関数呼び出しと混同しにくい

21.1 マクロの基本

macro_rules!はマクロを定義する際に用いる
→他にもコンパイラに組み込まれたマクロや手続きマクロなどがある

macro_rules!で定義されたマクロは完全にパターンマッチで動作する

macro_rules! macro_name {
    ($hoge1:expr, &hoge2:expr) /* pattern */ => ({
        match (&$hoge1, &$hoge2) { /* template */
            ... 
        }
    });
}

パターンやテンプレート周りの小括弧は大括弧や中括弧でも良い
→呼び出す際も同じ
→→中括弧を使えば;を省略できる

20.1.1 マクロ展開の基礎




































































































